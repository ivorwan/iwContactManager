@{
    ViewBag.Title = "Chat";
}
@section header
    {
    <style type="text/css">
        #chat {
            background-color: #99CCFF;
            border: thick solid #808080;
            padding: 20px;
            margin: 20px;
        }
    </style>
}
<div ng-controller="ChatController as chatCtrl" ng-app="iwContactManager">
    <form name="nameForm" ng-submit="nameForm.$valid && submitName()" novalidate>
        <input type="text" name="name" ng-model="name" required />
        <input type="submit" value="Submit" />
    </form>
    
    <span>{{chatCtrl.name}}</span>
    
    <h2>Chat</h2>
    <div class="form-horizontal">
        <div class="container" id="chat">
            <form name="messageForm" ng-submit="messageForm.$valid && greetAll()" novalidate>
                <input type="text" id="message" ng-model="message" required />
                <input type="submit" id="sendmessage" value="Send" />
            </form>
            
            <ul id="discussion" ng-repeat="msg in discussion">
                <li>{{msg.name}} : {{msg.message}}</li>
            </ul>
        </div>
    </div>

</div>


@section scripts{
    <!--Script references. -->


    <!--Reference the SignalR library. -->
    @Scripts.Render("~/Scripts/jquery.signalR-2.1.2.min.js")

    <!--Reference the autogenerated SignalR hub script. -->
    @Scripts.Render("~/signalr/hubs")

    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular-animate.js"></script>
    <script type="text/javascript" src="/Scripts/App.js"></script>

    <!--Add script to update the page and send messages.-->
    <script type="text/javascript">
        $(function () {
            // Declare a proxy to reference the hub.
            //var chat = $.connection.chatHub;
            // Create a function that the hub can call to broadcast messages.
            //chat.client.broadcastMessage = function (name, message) {
                // Html encode display name and message.
                //var encodedName = $('<div />').text(name).html();
                //var encodedMsg = $('<div />').text(message).html();
                // Add the message to the page.
                //$('#discussion').append('<li><strong>' + encodedName
                //    + '</strong>:&nbsp;&nbsp;' + encodedMsg + '</li>');
            //};
            // Get the user name and store it to prepend to messages.
            //$('#displayname').val(prompt('Enter your name:', ''));
            // Set initial focus to message input box.
            //$('#message').focus();
            // Start the connection.
            //$.connection.hub.start().done(function () {
                //console.log($.connection);
                //$('#sendmessage').click(function () {
                    // Call the Send method on the hub.
                    //chat.server.send($('#displayname').val(), $('#message').val());
                    // Clear text box and reset focus for next comment.
                    //$('#message').val('').focus();
                //});
            //});
        });
    </script>
}
